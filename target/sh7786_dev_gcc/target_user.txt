=====================================================================
                         SH7786_DEVターゲット依存部
                                  Last Modified: 2010 Jun 02 10:13:59
=====================================================================

○概要

SH7786_DEVターゲット依存部は，プロセッサにSH4A（SH7786）を搭載した，
（株）ルネサステクノロジ製のSH7786 65nm System Development Kit 
(SDK7786-65nm) をサポートしている．

○カーネルの使用リソース

カーネルは以下のリソースを使用する．

  ・RAM
     0x40000000から配置されているDDRにコードとデータを配置する．
     使用量はオブジェクト数に依存する．
  
  ・TMU0
     コア0のカーネル内部のティックの生成に用いる．

  ・TMU1
     コア1のカーネル内部のティックの生成に用いる．

  ・SCIFチャネル0
     コア0のコンソールの出力に使用．

  ・SCIFチャネル1
     コア1のコンソールの出力に使用．

○他のターゲットへの移植

SH7786_DEVターゲット依存部で使用するタイマやシリアルは，SH7786の内蔵機
能のみを使用するため，SH7786や近い構成のSH4Aを用いた環境には容易にポー
ティングが可能である．ポーティングに関しては，以下の初期化ルーチンにタ
ーゲット毎の初期化を追加すればよい．

  ・target_initialize() : target_config.c
    ターゲット依存部の初期化（C言語）
  ・_hardware_init_hook : target_support.S
    低レベルのターゲット依存の初期化
    スタートアップモジュールの中で，メモリの初期化の前に呼び出される


○デバッグ環境

デバッグ環境としては，JTAGデバッガの使用を前提とする．動作確認したデバ
ッガはE10Aであり，コンソトールソフトとしてHEWを用いている．

○コンパイラ

GCC 4.3.2 で動作確認を行った．動作確認した GCC は，以下のサイトからバ
イナリパッケージをダウンロードして用いた．

   http://www.superh-tkernel.org/jpn/download/tools/index.html


○ボードの設定

○コンソール出力

コンソール出力には，SCIFのチャネル0と1を用いる．通信フォーマットは以下
の通りである．

  ・115200bps, Data 8bit, Parity none, Stop 1bit, Flow control none

○カーネル終了時の処理

ext_ker が呼び出されカーネル終了時には，sh778_dev.h にある 
sh778_dev_exit() が実行される．ディフォルトでは，強制的にリセットを発
生させている．独自の処理処理を追加したい場合は，sh778_dev_exit() の内
容を書き換えること．

○ROM 化

現状はサポートしていない．

○各種設定の変更

幾つかのパラメータは変更可能になっている．設定ファイル毎に設定可能項目
は次のようになっている．

●Makefile.target の設定項目

・ROM_BOOT
  ROM化する場合はTRUEに定義する（現状サポートしていない）

・FPU_ENABLE
  FPUを使用する場合はTRUEに定義する

・FPU_MODE
  以下のFPUのモードの指定
   SINGLE      : ディフォルトは単精度
   SINGLE_ONLY : 単精度のみをサポート
   DOUBLE      : ディフォルトは倍精度  

・GCC_TARGET
  GCCの suffix を定義

・TEXT_START_ADDRESS/DATA_START_ADDRESS
  テキストセクション，データセクションの開始アドレス

・INCLUDES
  インクルード指定

・COPTS
  Cコンパイラへのオプション

・LDFLAGS
  リンカへのオプション

●target_config.h の設定項目

・DEFAULT_ISTKSZ
  ディフォルトの非タスクコンテキスト用のスタックサイズ

・CCR_MODE
  キャッシュモードの初期値

・FPU_SAVE_BANKED_REG
  FPUのバンクレジスタを保存するか

・SIL_DLY_TIM1/2
  微少時間待ちのための定義

●target_syssvc.h の設定項目

・SCIFX_BPS_SETTING
  コンソールに使用するポートのボーレート

・SCIFX_CKE_SETTING
  コンソールに使用するポートのクロックソース

○変更履歴
2010/06/02
・テスト関連のコードの削除．

2010/04/14
・sio_initializeをクローバル初期化ルーチンとして一度だけ呼び出すように
  変更．

2010/02/16
・target_serial.c に対する修正．

2010/02/10
・ASPカーネルの1.2.1 から 1.3.0 の修正に追従
  ・ierdyをirdyに変更．

2009/12/21
・新規作成

以上．
